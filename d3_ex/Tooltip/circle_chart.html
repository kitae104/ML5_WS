<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>슬라이더 사용</title>
    <link href="../../public/asserts/css/book.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/d3@3"></script>
    <script src="https://code.jquery.com/jquery-3.6.3.slim.min.js"
      integrity="sha256-ZwqZIVdD3iXNyGHbSYdsmWP//UBokj2FHAxKuSBKDSo="
      crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
      integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"></script>
  </head>
  <body>
    <h1 class="section-title">툴 팁 연습</h1>
    <div id="chart"></div>

    <script>    

function fruitChart1() {

// Chart Attributes
var width = 600,
    height = 120;

// Radius Extent
var radiusExtent = [0, 40];

// Charting Function
function chart(selection) {
    selection.each(function(data) {

        // Select the container div and create the svg selection
        var div = d3.select(this),
            svg = div.selectAll('svg').data([data]);

        // Append the svg element on enter
        svg.enter().append('svg');

        // Update the width and height of the SVG element
        svg
            .attr('width', width)
            .attr('height', height)
            .style("border", "2px solid rgba(255,0,0,0.9)");

        // Create a scale for the horizontal position
        var xScale = d3.scale.ordinal()
            .domain(d3.range(data.length))
            .rangePoints([0, width], 1);

        var maxCal = d3.max(data, function(d) {
            return d.calories;
        });

        // Create the radius scale
        var rScale = d3.scale.sqrt()
            .domain([0, maxCal])
            .rangeRound(radiusExtent);

        // Create a container group for each circle
        var gItems = svg.selectAll('g.fruit-item')
            .data(data)
            .enter()
            .append('g')
            .attr('class', 'fruit-item')
            .attr('transform', function(d, i) {
                return 'translate(' + [xScale(i), height / 2] + ')';
            });

        // Add a circle to the item group
        var circles = gItems.append('circle')
            .attr('r', function(d) { return rScale(d.calories); })
            .attr('fill', function(d) { return d.color; });

        // Add the fruit name
        var labelName = gItems.append('text')
            .attr('text-anchor', 'middle')
            .attr('font-size', '12px')
            .text(function(d) { return d.name; });

        // Add the calories label
        var labelKCal = gItems.append('text')
            .attr('text-anchor', 'middle')
            .attr('font-size', '10px')
            .attr('y', 12)
            .text(function(d) { return d.calories + ' kcal'; });

        // We add listeners to the mouseover and mouseout events
        circles
            .on('mouseover', function(d) {
                d3.select(this)
                    .attr('stroke-width', 3)
                    .attr('fill', d3.rgb(d.color).brighter())
                    .attr('stroke', d.color);
            })
            .on('mouseout', function(d) {
                d3.select(this)
                    .attr('fill', d.color)
                    .attr('stroke-width', 0);
            });
    });
}

// Accessor Methods

// Width
chart.width = function(val) {
    if (!arguments.length) { return width; }
    width = val;
    return chart;
};

// Height
chart.height = function(val) {
    if (!arguments.length) { return height; }
    height = val;
    return chart;
};

return chart;
}

// Load and parse the json data
d3.json('fruits.json', function(error, root) {

// Displays an error message
if (error) {
    console.error('Error getting or parsing the data.');
    throw error;
}
console.log(root);
// Create and configure the chart
var fruits = fruitChart1();

// Select the container element and invoke the fruit chart
d3.select('div#chart')
    .data([root.data])
    .call(fruits);
});
    </script>
  </body>
</html>
